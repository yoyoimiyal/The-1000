<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>键盘无冲测试</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .key {
            width: 40px;
            height: 40px;
            border: 1px solid #334155;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: #94a3b8;
            transition: all 0.05s;
        }

        .key.active {
            background-color: #22c55e;
            color: #fff;
            border-color: #22c55e;
            transform: translateY(2px);
            box-shadow: 0 0 10px #22c55e;
        }

        .key-wide {
            width: 60px;
        }

        .key-space {
            width: 200px;
        }

        .row {
            display: flex;
            gap: 4px;
            justify-content: center;
            margin-bottom: 4px;
        }
    </style>
</head>

<body class="bg-gray-900 min-h-screen flex flex-col items-center justify-center p-6 text-white select-none">

    <div class="w-full max-w-4xl">

        <header class="text-center mb-10">
            <h1 class="text-3xl font-bold text-green-400 mb-2">N-Key Rollover Test</h1>
            <p class="text-sm text-gray-400">同时按下尽可能多的按键，检测键盘冲突</p>
        </header>

        <div class="text-center mb-8">
            <div class="text-6xl font-black text-white" id="count">0</div>
            <p class="text-xs uppercase font-bold text-gray-500 mt-2">Simultaneous Keys Pressed</p>
            <p class="text-xs text-yellow-500 mt-1" id="max-count">Max: 0</p>
        </div>

        <!-- Keyboard Visual -->
        <div class="bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700 overflow-x-auto">
            <div class="min-w-max">
                <!-- Row 1 -->
                <div class="row">
                    <div class="key" id="Escape">ESC</div>
                    <div class="key" id="F1">F1</div>
                    <div class="key" id="F2">F2</div>
                    <div class="key" id="F3">F3</div>
                    <div class="key" id="F4">F4</div>
                    <div class="key" id="F5">F5</div>
                    <div class="key" id="F6">F6</div>
                    <div class="key" id="F7">F7</div>
                    <div class="key" id="F8">F8</div>
                    <div class="key" id="F9">F9</div>
                    <div class="key" id="F10">F10</div>
                    <div class="key" id="F11">F11</div>
                    <div class="key" id="F12">F12</div>
                </div>
                <!-- Row 2 -->
                <div class="row">
                    <div class="key" id="Backquote">`</div>
                    <div class="key" id="Digit1">1</div>
                    <div class="key" id="Digit2">2</div>
                    <div class="key" id="Digit3">3</div>
                    <div class="key" id="Digit4">4</div>
                    <div class="key" id="Digit5">5</div>
                    <div class="key" id="Digit6">6</div>
                    <div class="key" id="Digit7">7</div>
                    <div class="key" id="Digit8">8</div>
                    <div class="key" id="Digit9">9</div>
                    <div class="key" id="Digit0">0</div>
                    <div class="key" id="Minus">-</div>
                    <div class="key" id="Equal">=</div>
                    <div class="key key-wide" id="Backspace">←</div>
                </div>
                <!-- Row 3 -->
                <div class="row">
                    <div class="key key-wide" id="Tab">TAB</div>
                    <div class="key" id="KeyQ">Q</div>
                    <div class="key" id="KeyW">W</div>
                    <div class="key" id="KeyE">E</div>
                    <div class="key" id="KeyR">R</div>
                    <div class="key" id="KeyT">T</div>
                    <div class="key" id="KeyY">Y</div>
                    <div class="key" id="KeyU">U</div>
                    <div class="key" id="KeyI">I</div>
                    <div class="key" id="KeyO">O</div>
                    <div class="key" id="KeyP">P</div>
                    <div class="key" id="BracketLeft">[</div>
                    <div class="key" id="BracketRight">]</div>
                    <div class="key key-wide" id="Backslash">\</div>
                </div>
                <!-- Row 4 -->
                <div class="row">
                    <div class="key key-wide" id="CapsLock">CAPS</div>
                    <div class="key" id="KeyA">A</div>
                    <div class="key" id="KeyS">S</div>
                    <div class="key" id="KeyD">D</div>
                    <div class="key" id="KeyF">F</div>
                    <div class="key" id="KeyG">G</div>
                    <div class="key" id="KeyH">H</div>
                    <div class="key" id="KeyJ">J</div>
                    <div class="key" id="KeyK">K</div>
                    <div class="key" id="KeyL">L</div>
                    <div class="key" id="Semicolon">;</div>
                    <div class="key" id="Quote">'</div>
                    <div class="key key-wide" id="Enter">ENTER</div>
                </div>
                <!-- Row 5 -->
                <div class="row">
                    <div class="key key-wide" id="ShiftLeft">SHIFT</div>
                    <div class="key" id="KeyZ">Z</div>
                    <div class="key" id="KeyX">X</div>
                    <div class="key" id="KeyC">C</div>
                    <div class="key" id="KeyV">V</div>
                    <div class="key" id="KeyB">B</div>
                    <div class="key" id="KeyN">N</div>
                    <div class="key" id="KeyM">M</div>
                    <div class="key" id="Comma">,</div>
                    <div class="key" id="Period">.</div>
                    <div class="key" id="Slash">/</div>
                    <div class="key key-wide" id="ShiftRight">SHIFT</div>
                </div>
                <!-- Row 6 -->
                <div class="row">
                    <div class="key" id="ControlLeft">CTRL</div>
                    <div class="key" id="MetaLeft">WIN</div>
                    <div class="key" id="AltLeft">ALT</div>
                    <div class="key key-space" id="Space">SPACE</div>
                    <div class="key" id="AltRight">ALT</div>
                    <div class="key" id="MetaRight">WIN</div>
                    <div class="key" id="ContextMenu">MNU</div>
                    <div class="key" id="ControlRight">CTRL</div>
                </div>
            </div>
        </div>

        <div class="mt-8 text-center">
            <button onclick="resetStats()"
                class="text-xs text-gray-500 hover:text-white border border-gray-700 px-4 py-2 rounded-full transition mb-4">重置统计</button>
            <br>
            <a href="./navigation.html" class="text-xs text-gray-600 hover:text-gray-400">退出</a>
        </div>

    </div>

    <script>
        const pressedKeys = new Set();
        const countEl = document.getElementById('count');
        const maxEl = document.getElementById('max-count');
        let maxCount = 0;

        document.addEventListener('keydown', (e) => {
            e.preventDefault(); // Prevent scrolling/shortcuts

            if (!pressedKeys.has(e.code)) {
                pressedKeys.add(e.code);
                highlightKey(e.code, true);
                updateCount();
            }
        });

        document.addEventListener('keyup', (e) => {
            if (pressedKeys.has(e.code)) {
                pressedKeys.delete(e.code);
                highlightKey(e.code, false);
                updateCount();
            }
        });

        // Handle window blur (clear keys)
        window.addEventListener('blur', () => {
            pressedKeys.clear();
            document.querySelectorAll('.key.active').forEach(k => k.classList.remove('active'));
            updateCount();
        });

        function highlightKey(code, isActive) {
            const keyEl = document.getElementById(code);
            if (keyEl) {
                if (isActive) keyEl.classList.add('active');
                else keyEl.classList.remove('active');
            }
        }

        function updateCount() {
            const count = pressedKeys.size;
            countEl.innerText = count;
            if (count > maxCount) {
                maxCount = count;
                maxEl.innerText = "Max: " + maxCount;
            }
        }

        function resetStats() {
            maxCount = 0;
            maxEl.innerText = "Max: 0";
        }
    </script>
</body>

</html>