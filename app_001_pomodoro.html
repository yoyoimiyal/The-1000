<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>极简番茄钟</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .timer-circle {
            transition: stroke-dashoffset 1s linear;
        }
    </style>
</head>

<body class="bg-red-50 min-h-screen flex flex-col items-center justify-center font-sans text-slate-800">

    <div class="bg-white p-8 rounded-3xl shadow-xl w-full max-w-sm text-center">
        <h1 class="text-2xl font-bold mb-2 text-red-600">专注时刻</h1>
        <p class="text-slate-500 mb-8" id="status-text">准备开始专注了吗？</p>

        <div class="relative w-64 h-64 mx-auto mb-8">
            <!-- Progress Ring -->
            <svg class="w-full h-full transform -rotate-90">
                <circle cx="128" cy="128" r="120" stroke="#fee2e2" stroke-width="8" fill="none" />
                <circle id="progress-ring" cx="128" cy="128" r="120" stroke="#ef4444" stroke-width="8" fill="none"
                    stroke-dasharray="753.6" stroke-dashoffset="0" stroke-linecap="round" class="timer-circle" />
            </svg>
            <!-- Time Display -->
            <div class="absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center">
                <span id="timer" class="text-6xl font-bold text-slate-800 tracking-tighter">25:00</span>
            </div>
        </div>

        <div class="flex gap-4 justify-center">
            <button onclick="toggleTimer()" id="toggle-btn"
                class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition transform hover:scale-105 active:scale-95">
                开始
            </button>
            <button onclick="resetTimer()"
                class="bg-slate-200 hover:bg-slate-300 text-slate-600 font-bold py-3 px-6 rounded-full transition">
                重置
            </button>
        </div>

        <div class="mt-6 flex justify-center gap-2 text-sm">
            <button onclick="setMode('work')"
                class="px-3 py-1 rounded-full bg-red-100 text-red-600 font-medium hover:bg-red-200 transition">工作
                (25m)</button>
            <button onclick="setMode('break')"
                class="px-3 py-1 rounded-full bg-green-100 text-green-600 font-medium hover:bg-green-200 transition">休息
                (5m)</button>
        </div>

        <div class="mt-8">
            <a href="./navigation.html" class="text-slate-400 hover:text-slate-600 text-sm underline">← 返回导航</a>
        </div>
    </div>

    <script>
        let timeLeft = 25 * 60;
        let totalTime = 25 * 60;
        let timerId = null;
        let isRunning = false;

        const timerEl = document.getElementById('timer');
        const ringEl = document.getElementById('progress-ring');
        const toggleBtn = document.getElementById('toggle-btn');
        const statusText = document.getElementById('status-text');

        const CIRCLE_CIRCUMFERENCE = 2 * Math.PI * 120; // r=120

        function updateDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // Update Ring
            const offset = CIRCLE_CIRCUMFERENCE - (timeLeft / totalTime) * CIRCLE_CIRCUMFERENCE;
            ringEl.style.strokeDashoffset = offset;
        }

        function toggleTimer() {
            if (isRunning) {
                clearInterval(timerId);
                toggleBtn.textContent = '继续';
                toggleBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                toggleBtn.classList.add('bg-red-500', 'hover:bg-red-600');
                statusText.textContent = '已暂停';
                isRunning = false;
            } else {
                timerId = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateDisplay();
                    } else {
                        clearInterval(timerId);
                        isRunning = false;
                        toggleBtn.textContent = '完成';
                        statusText.textContent = '时间到！';
                        // Play sound or notify
                        alert("时间到！");
                    }
                }, 1000);
                toggleBtn.textContent = '暂停';
                toggleBtn.classList.remove('bg-red-500', 'hover:bg-red-600');
                toggleBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                statusText.textContent = '专注中...';
                isRunning = true;
            }
        }

        function resetTimer() {
            clearInterval(timerId);
            isRunning = false;
            timeLeft = totalTime;
            updateDisplay();
            toggleBtn.textContent = '开始';
            toggleBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
            toggleBtn.classList.add('bg-red-500', 'hover:bg-red-600');
            statusText.textContent = '准备好了吗？';
        }

        function setMode(mode) {
            clearInterval(timerId);
            isRunning = false;
            toggleBtn.textContent = '开始';
            toggleBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
            toggleBtn.classList.add('bg-red-500', 'hover:bg-red-600');

            if (mode === 'work') {
                totalTime = 25 * 60;
                statusText.textContent = '专注工作模式';
                ringEl.style.stroke = '#ef4444'; // Red
            } else {
                totalTime = 5 * 60;
                statusText.textContent = '休息模式';
                ringEl.style.stroke = '#10b981'; // Green
            }
            timeLeft = totalTime;
            updateDisplay();
        }

        // Init
        ringEl.style.strokeDasharray = `${CIRCLE_CIRCUMFERENCE} ${CIRCLE_CIRCUMFERENCE}`;
        ringEl.style.strokeDashoffset = 0;
    </script>
</body>

</html>