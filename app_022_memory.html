<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®°å¿†ç¿»ç‰ŒæŒ‘æˆ˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .perspective {
            perspective: 1000px;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .card-inner.flipped {
            transform: rotateY(180deg);
        }

        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .card-front {
            background-color: #3b82f6;
            background-image: linear-gradient(135deg, #3b82f6 25%, #2563eb 25%, #2563eb 50%, #3b82f6 50%, #3b82f6 75%, #2563eb 75%, #2563eb 100%);
            background-size: 20px 20px;
        }

        .card-back {
            background-color: white;
            transform: rotateY(180deg);
            font-size: 2rem;
            border: 2px solid #e5e7eb;
        }
    </style>
</head>

<body class="bg-slate-100 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="mb-6 flex justify-between items-end w-full max-w-md">
        <h1 class="text-2xl font-bold text-slate-800">Memory Game</h1>
        <div class="text-sm text-slate-500">æ­¥æ•°: <span id="moves" class="font-bold text-blue-600">0</span></div>
    </div>

    <!-- Game Board -->
    <div class="grid grid-cols-4 gap-3 w-full max-w-md h-[400px]" id="game-board">
        <!-- Cards injected by JS -->
    </div>

    <div class="mt-8 flex gap-4">
        <button onclick="restartGame()"
            class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full shadow-lg transition">
            é‡æ–°å¼€å§‹
        </button>
        <a href="./navigation.html"
            class="bg-white hover:bg-gray-50 text-slate-600 font-bold py-2 px-6 rounded-full shadow transition border border-gray-200">
            é€€å‡º
        </a>
    </div>

    <!-- Celebration Modal -->
    <div id="modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
        <div class="bg-white p-8 rounded-2xl text-center shadow-2xl transform scale-100 transition">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h2 class="text-2xl font-bold mb-2">æ­å–œ!</h2>
            <p class="text-slate-500 mb-6">ä½ ç”¨äº† <span id="final-moves">0</span> æ­¥å®Œæˆäº†æŒ‘æˆ˜ã€‚</p>
            <button onclick="restartGame()" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        const emojis = ['ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼'];
        const gameBoard = document.getElementById('game-board');
        const movesEl = document.getElementById('moves');
        const modal = document.getElementById('modal');
        const finalMovesEl = document.getElementById('final-moves');

        let cards = [];
        let hasFlippedCard = false;
        let lockBoard = false;
        let firstCard, secondCard;
        let moves = 0;
        let matchedPairs = 0;

        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function createBoard() {
            gameBoard.innerHTML = '';
            // Create pairs
            const deck = [...emojis, ...emojis];
            shuffle(deck);

            deck.forEach(emoji => {
                const card = document.createElement('div');
                card.classList.add('perspective', 'w-full', 'h-20', 'sm:h-24'); // Fixed height aspect

                card.innerHTML = `
                    <div class="card-inner w-full h-full" data-emoji="${emoji}">
                        <div class="card-front"></div>
                        <div class="card-back">${emoji}</div>
                    </div>
                `;

                card.querySelector('.card-inner').addEventListener('click', flipCard);
                gameBoard.appendChild(card);
            });
        }

        function flipCard() {
            if (lockBoard) return;
            if (this === firstCard) return; // Clicking same card twice

            this.classList.add('flipped');

            if (!hasFlippedCard) {
                // First click
                hasFlippedCard = true;
                firstCard = this;
                return;
            }

            // Second click
            secondCard = this;
            incrementMoves();
            checkForMatch();
        }

        function checkForMatch() {
            let isMatch = firstCard.dataset.emoji === secondCard.dataset.emoji;
            isMatch ? disableCards() : unflipCards();
        }

        function disableCards() {
            firstCard.removeEventListener('click', flipCard);
            secondCard.removeEventListener('click', flipCard);
            matchedPairs++;
            resetBoard();

            if (matchedPairs === emojis.length) {
                setTimeout(() => {
                    finalMovesEl.innerText = moves;
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }, 500);
            }
        }

        function unflipCards() {
            lockBoard = true;
            setTimeout(() => {
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
                resetBoard();
            }, 1000);
        }

        function resetBoard() {
            [hasFlippedCard, lockBoard] = [false, false];
            [firstCard, secondCard] = [null, null];
        }

        function incrementMoves() {
            moves++;
            movesEl.innerText = moves;
        }

        function restartGame() {
            moves = 0;
            matchedPairs = 0;
            movesEl.innerText = 0;
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            resetBoard();
            createBoard();
        }

        // Init
        createBoard();
    </script>
</body>

</html>