<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简易词云生成器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .word-tag {
            transition: all 0.3s;
            cursor: pointer;
            line-height: 1.2;
            display: inline-block;
            margin: 0.25rem;
        }

        .word-tag:hover {
            transform: scale(1.1);
            z-index: 10;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-slate-50 min-h-screen flex flex-col p-6 text-slate-800">

    <div class="w-full max-w-5xl mx-auto h-[90vh] flex flex-col">

        <header class="flex justify-between items-center mb-6 shrink-0">
            <h1 class="text-xl font-bold flex items-center gap-2 text-indigo-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                </svg>
                Simple Word Cloud
            </h1>
            <a href="./navigation.html" class="text-sm text-slate-400 hover:text-indigo-600">退出</a>
        </header>

        <div class="flex-1 flex flex-col md:flex-row gap-6 overflow-hidden">

            <!-- Input -->
            <div class="w-full md:w-1/3 flex flex-col bg-white rounded-xl shadow-sm border border-slate-200">
                <div
                    class="p-3 bg-slate-50 border-b border-slate-200 text-xs font-bold text-slate-500 uppercase flex justify-between">
                    <span>Source Text</span>
                    <button onclick="loadSample()" class="text-indigo-500 hover:underline">Sample</button>
                </div>
                <textarea id="input" class="flex-1 p-4 resize-none outline-none text-sm leading-relaxed"
                    placeholder="在此粘贴文本..." oninput="debounceGenerate()"></textarea>
                <div class="p-4 border-t border-slate-200 bg-slate-50">
                    <button onclick="generate()"
                        class="w-full py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition shadow">生成词云</button>
                </div>
            </div>

            <!-- Output -->
            <div
                class="flex-1 bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col relative overflow-hidden">
                <div
                    class="p-3 bg-slate-50 border-b border-slate-200 text-xs font-bold text-slate-500 uppercase flex justify-between items-center">
                    <span>Result</span>
                    <span id="word-count">0 words</span>
                </div>

                <div class="flex-1 p-8 overflow-auto flex flex-wrap items-center justify-center content-center bg-slate-50/50"
                    id="cloud-container">
                    <!-- Words injected here -->
                    <div class="text-slate-400 text-sm">Waiting for input...</div>
                </div>
            </div>

        </div>

    </div>

    <script>
        const input = document.getElementById('input');
        const container = document.getElementById('cloud-container');
        const countEl = document.getElementById('word-count');
        let timeout;

        // Simple Stopwords (English & Chinese basic)
        const stopWords = new Set(['the', 'and', 'is', 'in', 'at', 'of', 'on', 'for', 'to', 'it', 'that', 'this', 'with', 'a', 'an', 'as', 'are', 'by', 'be', 'from', 'or', 'was', 'but', 'not', 'he', 'she', 'they', 'we', 'you', 'i', 'me', 'my', 'his', 'her', 'their', '的', '了', '和', '是', '在', '有', '我', '他', '她', '它', '们', '这', '那', '之', '与', '对于', '到', '为']);

        function loadSample() {
            input.value = `JavaScript is a programming language that is one of the core technologies of the World Wide Web, alongside HTML and CSS. As of 2023, 98.7% of websites use JavaScript on the client side for webpage behavior, often incorporating third-party libraries. All major web browsers have a dedicated JavaScript engine to execute the code on users' devices. JavaScript is a high-level, often just-in-time compiled language that conforms to the ECMAScript standard. It has dynamic typing, prototype-based object-orientation, and first-class functions.`;
            generate();
        }

        function debounceGenerate() {
            clearTimeout(timeout);
            timeout = setTimeout(generate, 500);
        }

        function generate() {
            const text = input.value;
            if (!text.trim()) {
                container.innerHTML = '<div class="text-slate-400 text-sm">Waiting for input...</div>';
                countEl.innerText = "0 words";
                return;
            }

            // Normalize and split
            // Remove punctuation
            const cleanText = text.toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "");
            const words = cleanText.split(/\s+/);

            const freq = {};
            let maxFreq = 0;

            words.forEach(w => {
                if (w.length > 1 && !stopWords.has(w)) {
                    freq[w] = (freq[w] || 0) + 1;
                    if (freq[w] > maxFreq) maxFreq = freq[w];
                }
            });

            // Sort by freq
            const sortedWords = Object.keys(freq).sort((a, b) => freq[b] - freq[a]).slice(0, 50); // Top 50

            container.innerHTML = '';

            const colors = ['#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4', '#6366f1'];

            sortedWords.forEach(w => {
                const count = freq[w];
                const span = document.createElement('span');

                // Size mapping: Base 1rem, Max 4rem
                // Linear interpolation
                const size = 0.8 + (count / maxFreq) * 3;

                span.className = "word-tag font-bold";
                span.style.fontSize = `${size}rem`;
                span.style.color = colors[Math.floor(Math.random() * colors.length)];
                span.style.opacity = 0.7 + (count / maxFreq) * 0.3; // More freq = more opaque
                span.innerText = w;
                span.title = `${w}: ${count}`;

                container.appendChild(span);
            });

            countEl.innerText = `${sortedWords.length} terms`;
        }
    </script>
</body>

</html>