<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown 幻灯片</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        .slide-content h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .slide-content h2 {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: #334155;
        }

        .slide-content h3 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #475569;
        }

        .slide-content p {
            margin-bottom: 1rem;
            font-size: 1.25rem;
            line-height: 1.6;
            color: #4b5563;
        }

        .slide-content ul {
            list-style-type: disc;
            padding-left: 2rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .slide-content li {
            margin-bottom: 0.5rem;
        }

        .slide-content code {
            background-color: #f1f5f9;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
            color: #db2777;
        }

        .slide-content pre {
            background-color: #1e293b;
            color: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .slide-content blockquote {
            border-left: 4px solid #cbd5e1;
            padding-left: 1rem;
            font-style: italic;
            color: #64748b;
        }
    </style>
</head>

<body class="bg-slate-100 min-h-screen flex flex-col h-screen overflow-hidden">

    <!-- Header / Editor Mode -->
    <div id="editor-view" class="flex-1 flex flex-col md:flex-row p-4 gap-4 h-full">

        <div class="flex-1 flex flex-col bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="p-3 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
                <h1 class="font-bold text-slate-700">Markdown Editor</h1>
                <div class="flex gap-2">
                    <button onclick="loadSample()" class="text-xs text-blue-500 hover:underline">加载示例</button>
                    <a href="./navigation.html" class="text-xs text-slate-400 hover:text-slate-600">退出</a>
                </div>
            </div>
            <textarea id="source" class="flex-1 w-full p-4 resize-none outline-none font-mono text-sm leading-relaxed"
                placeholder="输入 Markdown 内容，使用 '---' 分隔幻灯片..."></textarea>
        </div>

        <div class="w-full md:w-64 flex flex-col justify-center gap-4">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 text-center">
                <h2 class="text-xl font-bold text-slate-800 mb-2">幻灯片预览</h2>
                <p class="text-sm text-slate-500 mb-6">使用 <code class="bg-gray-100 px-1 rounded">---</code> 分隔不同页</p>
                <button onclick="startPresent()"
                    class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition transform active:scale-95 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                            clip-rule="evenodd" />
                    </svg>
                    开始演示
                </button>
            </div>
        </div>

    </div>

    <!-- Presentation Mode -->
    <div id="present-view" class="fixed inset-0 bg-white z-50 hidden flex-col">

        <!-- Slide Content -->
        <div class="flex-1 flex items-center justify-center p-8 md:p-16 overflow-y-auto">
            <div id="slide-container" class="slide-content w-full max-w-4xl">
                <!-- Content Injected Here -->
            </div>
        </div>

        <!-- Controls -->
        <div class="h-16 bg-slate-50 border-t border-slate-200 flex items-center justify-between px-6 shrink-0">
            <div class="text-sm text-slate-400 font-mono">
                <span id="current-page">1</span> / <span id="total-pages">1</span>
            </div>

            <div class="flex gap-4">
                <button onclick="prevSlide()" class="p-2 rounded-full hover:bg-slate-200 text-slate-600 transition"
                    title="上一页 (Left)">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <button onclick="nextSlide()" class="p-2 rounded-full hover:bg-slate-200 text-slate-600 transition"
                    title="下一页 (Right/Space)">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
            </div>

            <button onclick="exitPresent()"
                class="text-sm text-slate-500 hover:text-red-500 font-bold uppercase">Exit</button>
        </div>

        <!-- Progress Bar -->
        <div class="h-1 bg-slate-200 w-full">
            <div id="progress-bar" class="h-full bg-indigo-600 transition-all duration-300" style="width: 0%"></div>
        </div>

    </div>

    <script>
        const editorView = document.getElementById('editor-view');
        const presentView = document.getElementById('present-view');
        const source = document.getElementById('source');
        const container = document.getElementById('slide-container');
        const currPageEl = document.getElementById('current-page');
        const totalPageEl = document.getElementById('total-pages');
        const progressEl = document.getElementById('progress-bar');

        let slides = [];
        let currentSlideIndex = 0;

        function loadSample() {
            source.value = `# Welcome to MD Slides
这是一个简单的演示工具。

---

## 主要功能

- 基于 **Markdown** 语法
- 使用 \`---\` 分隔幻灯片
- 极简设计

---

### 代码示例

\`\`\`javascript
console.log("Hello World");
\`\`\`

> 保持简单，保持愚蠢。

---

## 谢谢观看

[返回首页](./navigation.html)
`;
        }

        function startPresent() {
            const raw = source.value;
            if (!raw.trim()) {
                alert("请输入内容");
                return;
            }

            // Split by ---
            slides = raw.split(/^---$/gm).map(s => s.trim());
            currentSlideIndex = 0;

            editorView.classList.add('hidden');
            presentView.classList.remove('hidden');
            presentView.classList.add('flex');

            renderSlide();
        }

        function exitPresent() {
            presentView.classList.add('hidden');
            presentView.classList.remove('flex');
            editorView.classList.remove('hidden');
        }

        function renderSlide() {
            const content = slides[currentSlideIndex];
            container.innerHTML = marked.parse(content);

            currPageEl.innerText = currentSlideIndex + 1;
            totalPageEl.innerText = slides.length;

            const progress = ((currentSlideIndex + 1) / slides.length) * 100;
            progressEl.style.width = `${progress}%`;
        }

        function nextSlide() {
            if (currentSlideIndex < slides.length - 1) {
                currentSlideIndex++;
                renderSlide();
            }
        }

        function prevSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                renderSlide();
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (presentView.classList.contains('hidden')) return;

            if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') {
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                prevSlide();
            } else if (e.key === 'Escape') {
                exitPresent();
            }
        });

        // Init
        loadSample();
    </script>
</body>

</html>