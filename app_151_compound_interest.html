<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤åˆ©è®¡ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-emerald-50 min-h-screen p-6 flex flex-col items-center text-slate-700">

    <div class="w-full max-w-4xl bg-white p-8 rounded-3xl shadow-xl border border-emerald-100">

        <header class="flex justify-between items-center mb-8">
            <h1 class="text-2xl font-bold text-emerald-800 flex items-center gap-2">
                <span class="text-3xl">ğŸ“ˆ</span> Compound Interest
            </h1>
            <a href="./navigation.html" class="text-sm text-emerald-600 hover:underline">é€€å‡º</a>
        </header>

        <div class="flex flex-col md:flex-row gap-8">

            <!-- Inputs -->
            <div class="w-full md:w-1/3 space-y-6">

                <div>
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">åˆå§‹æœ¬é‡‘ (Principal)</label>
                    <div class="relative">
                        <span class="absolute left-3 top-3 text-slate-400">Â¥</span>
                        <input type="number" id="principal"
                            class="w-full pl-8 p-3 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500 font-bold"
                            value="10000" oninput="calculate()">
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">å¹´åˆ©ç‡ (Rate %)</label>
                    <div class="relative">
                        <input type="number" id="rate"
                            class="w-full p-3 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500 font-bold"
                            value="5" step="0.1" oninput="calculate()">
                        <span class="absolute right-3 top-3 text-slate-400">%</span>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">å¹´é™ (Years)</label>
                    <input type="range" id="years" min="1" max="50" value="10"
                        class="w-full h-2 bg-emerald-200 rounded-lg appearance-none cursor-pointer"
                        oninput="document.getElementById('year-val').innerText = this.value; calculate()">
                    <div class="text-right text-xs font-bold text-emerald-600 mt-1"><span id="year-val">10</span> å¹´
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-400 uppercase mb-2">æ¯å¹´è¿½åŠ  (Contribution)</label>
                    <div class="relative">
                        <span class="absolute left-3 top-3 text-slate-400">Â¥</span>
                        <input type="number" id="contribution"
                            class="w-full pl-8 p-3 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500 font-bold"
                            value="0" oninput="calculate()">
                    </div>
                </div>

                <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-center">
                    <p class="text-xs text-emerald-600 uppercase font-bold mb-1">æœ€ç»ˆé‡‘é¢</p>
                    <p class="text-3xl font-black text-emerald-800">Â¥<span id="final-amount">0</span></p>
                    <p class="text-xs text-emerald-500 mt-1">åˆ©æ¯æ”¶ç›Š: Â¥<span id="interest-earned">0</span></p>
                </div>

            </div>

            <!-- Chart -->
            <div
                class="flex-1 bg-slate-50 rounded-2xl p-4 border border-slate-200 flex flex-col justify-center min-h-[300px]">
                <canvas id="chart"></canvas>
            </div>

        </div>

    </div>

    <script>
        let chart;

        function calculate() {
            const P = parseFloat(document.getElementById('principal').value) || 0;
            const r = (parseFloat(document.getElementById('rate').value) || 0) / 100;
            const t = parseInt(document.getElementById('years').value) || 1;
            const c = parseFloat(document.getElementById('contribution').value) || 0;

            const labels = [];
            const dataTotal = [];
            const dataPrincipal = [];

            let currentTotal = P;
            let currentPrincipal = P;

            for (let i = 0; i <= t; i++) {
                labels.push('Year ' + i);
                dataTotal.push(currentTotal);
                dataPrincipal.push(currentPrincipal);

                if (i < t) {
                    // Interest for the year
                    currentTotal += currentTotal * r;
                    // Add contribution at end of year
                    currentTotal += c;
                    currentPrincipal += c;
                }
            }

            const finalAmount = currentTotal;
            const totalInvested = currentPrincipal;
            const interest = finalAmount - totalInvested;

            document.getElementById('final-amount').innerText = Math.round(finalAmount).toLocaleString();
            document.getElementById('interest-earned').innerText = Math.round(interest).toLocaleString();

            renderChart(labels, dataTotal, dataPrincipal);
        }

        function renderChart(labels, totalData, principalData) {
            const ctx = document.getElementById('chart').getContext('2d');

            if (chart) {
                chart.data.labels = labels;
                chart.data.datasets[0].data = totalData;
                chart.data.datasets[1].data = principalData;
                chart.update();
            } else {
                chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'æ€»èµ„äº§ (Total)',
                            data: totalData,
                            borderColor: '#059669', // emerald-600
                            backgroundColor: 'rgba(5, 150, 105, 0.1)',
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'æŠ•å…¥æœ¬é‡‘ (Principal)',
                            data: principalData,
                            borderColor: '#94a3b8', // slate-400
                            borderDash: [5, 5],
                            fill: false,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        return context.dataset.label + ': Â¥' + Math.round(context.raw).toLocaleString();
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function (value) { return 'Â¥' + value.toLocaleString(); }
                                }
                            }
                        }
                    }
                });
            }
        }

        // Init
        calculate();
    </script>
</body>

</html>