<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¬åŠ›å¹´é¾„æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        input[type=range] {
            height: 6px;
            border-radius: 3px;
            background: #cbd5e1;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            background: #4f46e5;
            border-radius: 50%;
            cursor: pointer;
            margin-top: -9px;
            border: 4px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body class="bg-indigo-50 min-h-screen flex flex-col items-center justify-center p-6 text-slate-800">

    <div class="w-full max-w-lg bg-white p-8 rounded-3xl shadow-xl border border-indigo-100 text-center">

        <header class="flex justify-between items-center mb-10">
            <h1 class="text-xl font-bold text-indigo-800 flex items-center gap-2">
                <span class="text-2xl">ğŸ‘‚</span> Hearing Test
            </h1>
            <a href="./navigation.html" class="text-sm text-indigo-400 hover:text-indigo-600">é€€å‡º</a>
        </header>

        <div class="mb-8 p-4 bg-yellow-50 text-yellow-800 text-xs rounded-lg text-left">
            âš ï¸ <strong>è­¦å‘Šï¼š</strong> è¯·å…ˆå°†ç³»ç»ŸéŸ³é‡è°ƒä½ï¼Œä»¥å…æŸä¼¤å¬åŠ›ã€‚å»ºè®®ä½©æˆ´è€³æœºè¿›è¡Œæµ‹è¯•ã€‚
        </div>

        <div class="mb-10">
            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Frequency (Hz)</p>
            <div class="text-6xl font-black text-indigo-600 font-mono tabular-nums mb-2" id="freq-display">8000</div>
            <p class="text-sm font-bold text-slate-500" id="age-display">Age: All ages</p>
        </div>

        <div class="space-y-8">
            <input type="range" id="freq-slider" min="8000" max="22000" step="100" value="8000" class="w-full"
                oninput="update()">

            <button onclick="togglePlay()" id="play-btn"
                class="w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-2xl shadow-lg transition transform active:scale-95 text-lg flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                æ’­æ”¾å£°éŸ³
            </button>
        </div>

        <div class="mt-8 text-left text-xs text-slate-400 space-y-1">
            <p>8,000 Hz - æ‰€æœ‰äººå¯è§ (All)</p>
            <p>12,000 Hz - 50å²ä»¥ä¸‹ (Under 50)</p>
            <p>15,000 Hz - 40å²ä»¥ä¸‹ (Under 40)</p>
            <p>16,000 Hz - 30å²ä»¥ä¸‹ (Under 30)</p>
            <p>17,000 Hz - 24å²ä»¥ä¸‹ (Under 24)</p>
            <p>19,000 Hz - 20å²ä»¥ä¸‹ (Under 20)</p>
        </div>

    </div>

    <script>
        const slider = document.getElementById('freq-slider');
        const display = document.getElementById('freq-display');
        const ageEl = document.getElementById('age-display');
        const btn = document.getElementById('play-btn');

        let audioCtx;
        let osc;
        let gainNode;
        let isPlaying = false;

        function getAge(freq) {
            if (freq >= 19000) return "Under 20";
            if (freq >= 17000) return "Under 24";
            if (freq >= 16000) return "Under 30";
            if (freq >= 15000) return "Under 40";
            if (freq >= 12000) return "Under 50";
            return "Everyone";
        }

        function update() {
            const freq = slider.value;
            display.innerText = freq;
            ageEl.innerText = "Age: " + getAge(freq);

            if (isPlaying && osc) {
                osc.frequency.setTargetAtTime(freq, audioCtx.currentTime, 0.1);
            }
        }

        function togglePlay() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            if (isPlaying) {
                stop();
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg> æ’­æ”¾å£°éŸ³`;
                btn.classList.replace('bg-red-600', 'bg-indigo-600');
                btn.classList.replace('hover:bg-red-700', 'hover:bg-indigo-700');
            } else {
                start();
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg> åœæ­¢æ’­æ”¾`;
                btn.classList.replace('bg-indigo-600', 'bg-red-600');
                btn.classList.replace('hover:bg-indigo-700', 'hover:bg-red-700');
            }
        }

        function start() {
            osc = audioCtx.createOscillator();
            gainNode = audioCtx.createGain();

            osc.type = 'sine';
            osc.frequency.value = slider.value;

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // Smooth start
            gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.1, audioCtx.currentTime + 0.1); // Low volume for safety

            osc.start();
            isPlaying = true;
        }

        function stop() {
            if (osc) {
                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.1);
                osc.stop(audioCtx.currentTime + 0.1);
                osc = null;
            }
            isPlaying = false;
        }
    </script>
</body>

</html>