<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>精准点击训练</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .target {
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #ef4444 30%, white 31%, white 50%, #ef4444 51%);
            border-radius: 50%;
            position: absolute;
            cursor: crosshair;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: transform 0.05s;
        }

        .target:active {
            transform: scale(0.9);
        }

        .game-area {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="6" x2="12" y2="18"/><line x1="6" y1="12" x2="18" y2="12"/></svg>') 12 12, crosshair;
        }
    </style>
</head>

<body class="bg-gray-900 text-white h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <div class="flex justify-between items-center p-4 bg-gray-800 border-b border-gray-700 z-10">
        <h1 class="font-bold text-xl tracking-wider">AIM TRAINER</h1>
        <div class="flex gap-8 font-mono text-xl">
            <div>Score: <span id="score" class="text-green-400">0</span></div>
            <div>Time: <span id="time" class="text-yellow-400">30</span>s</div>
        </div>
        <a href="./navigation.html" class="text-sm text-gray-400 hover:text-white">退出</a>
    </div>

    <!-- Game Area -->
    <div id="game-area" class="flex-1 relative bg-gray-900 game-area overflow-hidden">

        <!-- Start Overlay -->
        <div id="start-overlay" class="absolute inset-0 flex flex-col items-center justify-center bg-black/80 z-20">
            <h2 class="text-4xl font-bold mb-4">准备好了吗？</h2>
            <p class="text-gray-400 mb-8">在 30 秒内尽可能多地点击目标</p>
            <button onclick="startGame()"
                class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-10 rounded-full text-lg transition transform hover:scale-105">
                开始游戏
            </button>
        </div>

        <!-- Result Overlay -->
        <div id="result-overlay"
            class="absolute inset-0 flex flex-col items-center justify-center bg-black/90 z-20 hidden">
            <h2 class="text-4xl font-bold mb-2">时间到!</h2>
            <div class="text-6xl font-bold text-green-400 mb-4" id="final-score">0</div>
            <p class="text-gray-400 mb-8" id="accuracy-text">CPS: 0</p>
            <button onclick="startGame()"
                class="bg-white text-gray-900 font-bold py-3 px-10 rounded-full text-lg hover:bg-gray-200 transition">
                再来一次
            </button>
        </div>

    </div>

    <script>
        const gameArea = document.getElementById('game-area');
        const scoreEl = document.getElementById('score');
        const timeEl = document.getElementById('time');
        const startOverlay = document.getElementById('start-overlay');
        const resultOverlay = document.getElementById('result-overlay');
        const finalScoreEl = document.getElementById('final-score');
        const accText = document.getElementById('accuracy-text');

        let score = 0;
        let timeLeft = 30;
        let timerId;
        let isPlaying = false;

        function startGame() {
            score = 0;
            timeLeft = 30;
            isPlaying = true;

            scoreEl.innerText = 0;
            timeEl.innerText = 30;

            startOverlay.classList.add('hidden');
            resultOverlay.classList.add('hidden');

            // Clear existing targets
            gameArea.innerHTML = '';
            gameArea.appendChild(startOverlay);
            gameArea.appendChild(resultOverlay);

            spawnTarget();

            timerId = setInterval(() => {
                timeLeft--;
                timeEl.innerText = timeLeft;
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function spawnTarget() {
            if (!isPlaying) return;

            const target = document.createElement('div');
            target.className = 'target';

            // Random Pos
            // Subtract target size (50px) to stay in bounds
            const maxX = gameArea.clientWidth - 60;
            const maxY = gameArea.clientHeight - 60;

            const x = Math.random() * maxX;
            const y = Math.random() * maxY;

            target.style.left = x + 'px';
            target.style.top = y + 'px';

            target.onmousedown = (e) => hitTarget(e, target);

            gameArea.appendChild(target);
        }

        function hitTarget(e, el) {
            e.stopPropagation();
            if (!isPlaying) return;

            score++;
            scoreEl.innerText = score;
            el.remove();
            spawnTarget();
        }

        function endGame() {
            isPlaying = false;
            clearInterval(timerId);

            finalScoreEl.innerText = score;
            const cps = (score / 30).toFixed(2);
            accText.innerText = `平均速度: ${cps} 点击/秒`;

            resultOverlay.classList.remove('hidden');
        }
    </script>
</body>

</html>