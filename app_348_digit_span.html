<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­—è®°å¿†å¹¿åº¦æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-slate-900 min-h-screen flex flex-col items-center justify-center p-6 text-white select-none">

    <div class="w-full max-w-md text-center">

        <header class="mb-12">
            <h1 class="text-3xl font-bold mb-2">Digit Span Test</h1>
            <p class="text-xs text-slate-400">å¹³å‡æ°´å¹³: 7 ä½æ•°å­—</p>
        </header>

        <!-- Start Screen -->
        <div id="screen-start" class="fade-in">
            <div class="text-6xl mb-6">ğŸ§ </div>
            <p class="text-slate-300 mb-8 leading-relaxed">
                å±å¹•ä¸Šä¼šä¾æ¬¡æ˜¾ç¤ºä¸€ä¸²æ•°å­—ã€‚<br>
                è¯·è®°ä½å®ƒä»¬ï¼Œç„¶ååœ¨è¾“å…¥æ¡†ä¸­å¤è¿°ã€‚<br>
                æ¯å…³å¢åŠ ä¸€ä½æ•°å­—ã€‚
            </p>
            <button onclick="startGame()"
                class="px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-full shadow-lg transition transform hover:scale-105">
                å¼€å§‹æµ‹è¯•
            </button>
        </div>

        <!-- Display Screen -->
        <div id="screen-display" class="hidden">
            <p class="text-xs text-slate-500 uppercase font-bold mb-8">Memorize</p>
            <div id="digit-display" class="text-9xl font-black text-white font-mono"></div>
        </div>

        <!-- Input Screen -->
        <div id="screen-input" class="hidden">
            <p class="text-xs text-slate-500 uppercase font-bold mb-4">Recall</p>
            <p class="mb-4 text-slate-300">åˆšæ‰çš„æ•°å­—æ˜¯ï¼Ÿ</p>
            <input type="number" id="user-input"
                class="w-full p-4 bg-slate-800 border-2 border-slate-700 rounded-xl text-center text-3xl font-mono outline-none focus:border-indigo-500 text-white tracking-widest"
                placeholder="?" onkeydown="if(event.key==='Enter') checkAnswer()">
            <button onclick="checkAnswer()"
                class="mt-6 px-8 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-full shadow-lg transition w-full">
                æäº¤
            </button>
        </div>

        <!-- Result Screen -->
        <div id="screen-result" class="hidden">
            <div id="result-icon" class="text-6xl mb-4">âŒ</div>
            <h2 class="text-2xl font-bold mb-2" id="result-title">Game Over</h2>
            <p class="text-slate-400 mb-2">æ­£ç¡®ç­”æ¡ˆ: <span id="correct-answer" class="text-white font-mono"></span></p>
            <p class="text-slate-400 mb-8">ä½ çš„æˆç»©: <span id="final-score"
                    class="text-yellow-400 font-bold text-xl">0</span> ä½</p>
            <button onclick="startGame()"
                class="px-8 py-3 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-full transition">
                å†è¯•ä¸€æ¬¡
            </button>
        </div>

    </div>

    <div class="fixed bottom-6 w-full text-center">
        <a href="./navigation.html" class="text-xs text-slate-600 hover:text-white">é€€å‡º</a>
    </div>

    <script>
        const digitDisplay = document.getElementById('digit-display');
        const userInput = document.getElementById('user-input');
        const correctAnsEl = document.getElementById('correct-answer');
        const finalScoreEl = document.getElementById('final-score');

        let currentSequence = "";
        let level = 3; // Start with 3 digits

        function showScreen(id) {
            document.querySelectorAll('div[id^="screen-"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).classList.add('fade-in');
        }

        function startGame() {
            level = 3;
            nextLevel();
        }

        function nextLevel() {
            currentSequence = "";
            for (let i = 0; i < level; i++) {
                currentSequence += Math.floor(Math.random() * 10);
            }

            showScreen('screen-display');
            playSequence();
        }

        function playSequence() {
            let i = 0;
            digitDisplay.innerText = "";

            const interval = setInterval(() => {
                if (i < currentSequence.length) {
                    digitDisplay.innerText = currentSequence[i];
                    // Optional: TTS? No, visual test.
                    i++;
                } else {
                    clearInterval(interval);
                    setTimeout(() => {
                        digitDisplay.innerText = "";
                        showInput();
                    }, 500); // Pause before input
                }
            }, 1000); // 1 sec per digit
        }

        function showInput() {
            showScreen('screen-input');
            userInput.value = "";
            userInput.focus();
        }

        function checkAnswer() {
            const val = userInput.value;
            if (val === currentSequence) {
                level++;
                nextLevel();
            } else {
                gameOver();
            }
        }

        function gameOver() {
            showScreen('screen-result');
            correctAnsEl.innerText = currentSequence;
            finalScoreEl.innerText = level - 1; // Completed level
        }
    </script>
</body>

</html>